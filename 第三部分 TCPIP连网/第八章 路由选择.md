# 第八章 路由选择

## 8.1 TCP/IP中的路由选择

在大多数基本形式中，路由器是负责根据逻辑地址对通信流量进行过滤的设备，经典的网络路由器工作于网际层（OSI模型的网络层），使用网际层报头中的IP寻址信息，网络层在OSI中也被称为第三层，因此路由器有时也被称为第三层设备，近些年来，硬件厂商已经开发出了可以工作在OSI协议栈更高层的路由器

像Internet这样的大型网络具有很多路由器，提供了源到目的节点的多条路径，这些路由器必须独立工作，但是整个系统必须保证数据能够准确高效的在网络中传输

当路由器将数据从一个网络传输到下一个网络时，它会替换网络访问层报头信息，因此路由器可以连接不同类型的网络，很多路由器还维护关于最佳路径的详细信息，这是根据距离，带宽和时间综合考虑而得到的

### 8.11 什么是路由器

描述路由器最好的方式是描述其外观，在它的最简单形式中，路由器看上去就像一台具有两块网络适配器的计算机，早起的路由器实际上就是具有两块或多块网络适配器的计算机（也被称为多宿主计算机）

**多宿主计算机充当路由器** 

![image-20200506110009157](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506110009157.png)

理解路由器的第一个步骤是要记住IP地址是属于适配器的，而不是术语计算机的，上图中的计算机有两个IP地址，一个适配器一个，实际上这两个适配器可以具有完全不同的IP子网，对应于玩去哪不同的物理网络，在多宿主计算机上的协议软件能够从网段A接收数据，查看IP地址信息来端盘数据是否属于网段B，如果是，就将其中的网络访问层报头信息替换为包含网段B物理地址信息的报头，再把数据传递给网络B，在这种简单的场景中，多宿主计算机起到了路由器的作用

如果想理解世界级网络在做什么，可以按照下面的思路把上面这个场景复杂化

* 路由器的端口（适配器）超过两个，也就是同时连接两个以上的网络。决定向哪里转发数据就变得更复杂了，而且很可能增加冗余路径（事实上，终端用户在大多数LAN中见到的路由器用于连接两个网段，但是在Internet结构内可以存在更为复杂的场景）
* 由路由器连接起来的网络还分别与其他网络连接。换句话说，路由器观察到的网络地址可能并不属于它直接连接的网络，它必须具有某种策略把数据转发到这些非直连网络上
* 路由器网络提供了冗余的路径，每台路由器必须能够以某种方式决定使用哪个路径

**复杂网络中的路由** 

![image-20200506110810692](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506110810692.png)

### 8.1.2 路由选择过程

路由器功能更全面介绍如下所述

1. 路由器从所连接的网络之一接收数据
2. 路由器把数据传递到协议栈的网际层，换句话说，路由器抛弃网络访问层报头信息，并重组IP数据报
3. 路由器检查IP报头中的目的地址
4. 如果数据的目的在其他网络，路由器就根据路由表决定向哪里转发数据
5. 在路由器决定了它的哪个适配器要接收这个数据后，就把数据传递到适当的网络访问层软件，让数据通过适配器进行传输

路由过程如下图所示，路由表和建立路由表的协议是路由器具有的两个显著特性，对于路由器的大多数讨论都是关于建立路由表，汇集路由表的路由协议如何让所以的路由器像一个整体一样提供服务

路由的类型主要有两种，它们的名称就源自于从何处获得路由表信息

* 静态路由：要求网络管理员手工输入路由信息
* 动态路由：根据使用路由协议获得的路由信息来动态建立路由表

**复杂网络中的路由** 

![image-20200506114817019](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506114817019.png)

静态路由可以用于一些特定场合，但是这种需要由管理员手动输入路由信息的系统必定存在严重的局限性，首先，静态路由不能很好的适应包含数百个可行路由的大型网络，其次，除了最简单的网络之外，静态路由需要网络管理员投入大量时间，因为不仅要创建路由表，还要持续更新其中的信息，另外，静态路由表不能迅速的跟随网络的变化而变化，比如当一台路由器关机时，它不能迅速地作出相应的改变

**注意：预配置的路由** 

大多数动态路由允许管理员覆盖动态路由，并且对特定地址配置静态路径，预配置的静态路由有时可以用于网络排错，有时也可以用于强制使用快速网络连接或平衡网络流量

### 8.1.3 路由表的概念

路由表和网际层其他路由元素的用途在于把数据传递到正确的本地网络，当数据达到本地网络之后，网络访问协议就会知道它的目的地，因此，路由表不需要存储完整的IP地址，只需要列出网络ID即可

下图所示为一个非常基本的路由表内容，从本质上讲，路由表就是把目的网络ID映射到吓一跳的IP地址，即数据报通往目的网络的下一站，路由表会区分直接连接到路由器本身的网络和通过其他路由器间接连接过来的网络。下一跳可是是目的网络（如果是直接连接），也可以是通向目的网络的下一个下游路由器，图中的路由器端口接口是指转发数据的路由器端口

**路由表** 

![image-20200506124254934](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506124254934.png)

路由表中的“下一跳”条目是理解动态路由的关键，在复杂的网络中，可能存在着通向目的的多条路径，路由器必须决定下一跳沿着哪条路径前进，动态路由器基于使用路由协议获得信息来做出决定

**注意：路由表** 

主机计算机可以像路由器一样具有路由表，但由于主机不需要执行路由功能，它的路由表通常不会那么复杂，主机通常会使用默认路由或默认网关，当数据报不能在本地网络上传输或传递到另一台路由器时，它就会被传递到充当默认网关的路由器

### 8.1.4 IP转发

主机和路由器都有路由表，主机的路由表比路由器的简单得多，它可能只包含两行：一个条目用于本地网络，另一个用于默认路由（用于处理不能在本地网段上传输的数据包）。这种基本的路由信息对于把数据报指向其目的来说足够了。

主机和路由器都有路由表，主机的路由表比路由器的简单很多，它可能只包含两行：一行用于本地网络，另一个用于默认路由（用于处理不能在本地网段上传输的数据包）这种基本的路由信息对于把数据报指向其目的来说足够了

在第4章讲到，TCP/IP软件利用ARP把IP地址解析为本地网段上的物理地址，但如果 IP 地址不在本地网段上会怎么样呢？如果 IP 地址不在本地网段上，主机会把数据报发送到路由器。现在有人也许已经发现了，实际情况不是这么简单的。IP报头只包含了源和目的的IP地址，它没有足够的空间来列出能够传输数据报的中间路由器的地址。前面提到过，IP转发过程实际上不会在IP报头中写入路由器的地址，而是由主机把数据报和路由器的IP地址向下传递到网络访问层，该层的协议软件会使用一个独立的查询过程把数据报封装到一个帧中，通过本地网段传递给路由器。换句话说，被转发的数据报里的 IP地址指向最终要接收数据的主机，而转发数据报的帧中的物理地址指向路由器上本地适配器的地址。

**IP转发过程** 

![image-20200506165911570](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506165911570.png)

1. 一台主机准备发送一个IP数据报，它查看自己的路由表
2. 如果数据报不能在本地网络上进行发送，主机就会从路由表里获取与目的地址相关联的路由器的IP地址（对于本地网段上的主机来说，这个路由器的IP地址一般都是默认网关地址）路由器的IP地址被ARP协议解析为物理地址
3. 数据报（目的远程主机）和路由器的物理地址一起被传递给网络访问层
4. 路由器的网络适配器会接收这个帧，因为帧的目的物理地址与路由器的物理地址相匹配
5. 路由器对帧进行拆包，把数据报传递给网际层
6. 路由器查看数据报的IP地址，如果这个地址匹配路由器自己的IP地址，就表示是要发给路由器本身的，否则，路由器就会查看自己的路由表，找到与数据报目的地址相关联的路由器，尝试转发这个数据报
7. 如果不能把数据报发送到与路由器相连接的任何网段，路由器就把数据报发给另一台路由器，上述过程可能会重复进行，直到最后一个路由器能够把数据报直接传输给目的主机

第六步是路由器的一个重要特性，需要记住的是，并不是具有两块网卡的设备就能充当路由器，如果没有必要的软件来支持IP转发，就不能把数据从一个接口传递到另一个，当不具备IP转发功能的计算机接收到目标是其他计算机的数据报时，它只会忽略收到的数据

### 8.1.5 直接路由与间接路由

如果一台路由器只连接了两个子网，路由表就会相当简单，下图所示的路由器不回看到没有与其端口相关联的IP地址，而且它是直接连接在全部子网上的，换句话说，图中的路由器能够利用直接路由传输任何数据报

**连接两个网段的路由器可以直接到达每个网段** 

![image-20200506170919600](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506170919600.png)

再来看一看下图中更复杂的网络，在这种情况下，路由器A没有连接到网段3，而且在没有帮助的情况下也不能发现网段3，这种情况称为间接路由，大多数路由式网络都在某种程序上依赖于间接路由，大型的公司网络可能具有十几个路由器，每个网段直接连接的路由器一般不超过一两个，稍后将介绍大型网络，到目前为止最大的问题是，下图中路由器A如何发现网段3？路由器A如何知道发往网段3的数据报应该转发给路由器B而不是路由器C呢？

**当路由器需要将数据报转发到非直接连接的网络时，必须执行间接路由选择** 

路由器了解间接路由的方式有两种：从系统管理员和从其他路由器

这两种方式分别对应于静态路由和动态路由，系统管理员可以直接向路由表中输入网络路由（静态路由），或者路由器B可以告诉路由器A关于网段3的信息（动态路由），动态路由具有一些优点，首先，它不需要人工干预，其次，它可以对网络的改变作出响应，如果一个新的网段连接到了路由器B，路由器B就能把这个改变通知路由器A

事实证明，对于小型，简单和固定网络来说，静态路由式一种有效的方法，如上图所示的简单网络就可以使用静态路由，但随着路由器适量的增加，静态路由会变得非常不适应，网段数量的增加会让路由器数量成倍增加，为管理员增加大量额外的工作量，更重要的是，在大型网络上，静态路由的交互会导致效率降低和诡异的行为，比如路由环路（数据报一直在路由器之间不停的循环，直到TTL值为0）

大多数现代路由器使用了某种形式的动态路由，路由器彼此之间相互通信，共享关于网段和网络路径的信息，每台路由器都根据从这种通信过程中得到的信息建立自己的路由表

**注意：** 静态路由和动态路由

路由器有时会同时使用静态路由和动态路由，系统管理员可以配置一些静态路径，让其他路径动态分配，静态路由有时可以用于强制流量经过特定路径，例如，系统管理员通过配置路由器可以把流量导向带宽比较大的连接

### 8.1.6 动态路由器算法

路由方法之-----矢量路由和链路状态路由

RIP（距离矢量路由协议）和OSPF（链路状态路由协议）

**说明：** 协议和实现

距离矢量和链路状态是路由协议的类别，实际协议的具体实现还包括其他特性和细节，另外，很多路由器支持启动脚本，静态路由条目等功能，使对距离矢量或链路状态路由的理想化描述变得非常复杂

1. 距离矢量路由

   距离矢量路由（也被称为贝尔曼-福特路由）是一种高效，简单的路由方法，被很多路由协议所采用，它曾经在路由器占统治地位，虽然最近几年一些更复杂的路由方法（比如链路状态路由）逐渐流行起来，但距离矢量路由仍然相当常见

   距离矢量路由的设计目标是让路由器之间所需的通信最少，让路由表中必须保留的数据最少。这种设计理念认为路由器不必知道通向每个网段的完整路径，而是只需知道向哪个方向发送数据报即可（这也是术语“矢量”的由来）。网段之间的距离以数据报在两个网络之间传输必须经过的路由器的数量来表示，而使用距离矢量路由的路由器优化路径的方式是让数据报必须经过的路由器达到最少。这个距离参数被称为“跳数”。

   距离矢量路由的工作方式如下所示：

   1. 当路由器A初始化时，它感知到直接连接的网段，并把这些网段写入到自己的路由表中，这些直连网段的跳数是0，因为数据报从这台路由器到达这些网段不需要经过其他路由器
   2. 在周期性的时间间隔中，路由器接收到来自邻居路由器的报告，其中包含了邻居路由器所感知的网段和响应的跳数
   3. 当路由器A从邻居路由器收到报告后，按照如下方法把新路由信息添加到自己的路由表中

   * 如果路由器B的信息中包含一个路由器A目前还不知道的网段，路由器A就把这个网段添加到自己的路由表中，去往这个新网段的路由就是路由器B，也就是说，如果路由器A收到发向这个新网段的数据报，它会转发给路由器B，对于路由器A来说，这个新网段的跳数是路由器B的信息中列出的跳数在加1，因为它与路由器B相比，达到这个网段需要多一跳

   * 如果路由器B的信息中包含的网段已经存在于路由器A的路由表中，路由器A就会把收到的跳数加1，把得到的值域自己路由表中的值相比较，如果经过路由器B的路径比路由器A已经掌握的路径更有效率（跳数更小）路由器A就会更新自己的路由表，把路由器B作为通向相应网段的路径

   * 如果通过路由器B的跳数比路由器A路由表中当前的路径跳数大，经过路由器B的路径就不会被使用，路由器A继续使用自己路由表中保存的路径

     随着每一轮路由表的更新，路由器对网络的了解越来越全面，关于路由的信息逐渐散布到整个网络，假设网络不发生改变，路由器就会最终了解到通向每个网段的最高效的路径

     下图是一个距离矢量路由更新的例子，路由器A和路由器都没有直连的网段，在这种情况下，路由器B具有通向网络14的更优路径，所以路由器A就更新自己的路由表，把发往网络14的数据转发给路由器B，对于网络7来说，路由器A已经掌握的路径更好，所以路由表中相应的内容没有改变

     **距离矢量路由更新** 

     ![image-20200506192135915](https://raw.githubusercontent.com/christopher-x/images/main/image-20200506192135915.png)

2. 链路状态路由

   在假定路径效率等同于经过的路由器数量时，距离矢量路由是个很好的方法，这种假设的初衷很好，但在有些情况下过于简单了（即使在跳数一样的请看下，经过低速链路的路由也会比经过高速链路的慢）另外，距离矢量路由并不特使适用于具有大量路由器的环境，因为每台路由器为每个目的网段都必须维护一个路由条目，而这些条目不过是矢量和跳数，路由器无法充分利用对网络结构的更多了解来提升其效率，而且，实际在大量信息都不必要的情况下，包含距离和跳数的完整表格必须在路由器之间进行传输，计算机科学家开始思考能否做的更好，由此诞生了链路状态路由，而且它已经成为距离矢量路由的主要对手

   连接状态路由背后的理念在于每个路由器都尝试建立关于网络拓扑的内部映射。每台路由器定期向网络发送状态信息，其中列出了自己直连的其他路由器以及链路的状态（链路在当前是否可用）。路由器利用从其他路由器收到的状态消息建立网络拓扑的映射，当它需要转发数据报时，会根据现有条件选择最佳路径

   连接状态路由在每台路由器上都需要更多的处理时间，但带宽消耗减少，因为每台路由器不需要传播完整的路由表。另外，通过网络追踪故障更容易了，因为特定路由器发出的状态消息在网络上传输时不会被改变（而在另一方面，使用距离矢量路由方法的路由器会在收到路由消息时修改其中的跳数）

## 8.2 复杂网络上的路由

Internet由各个独立管理的网络组成，这些网络成为自治系统，自治系统可以是个公司网络，但目前更常见的是与Internet服务供应商（ISP）相关联的网络，自治系统的所有者管理每台路由器的配置细节，大多数路由器按照如下的通用分类进行职责划分，尽管一台路由器可以充当多种职责，但是路由器所使用的硬件，尤其是协议，确定了它在网络中的职责

* 外部路由器：外部路由器在自治网络之间交换路由信息，它们维护自己及邻居自治网络的路由信息，边界路由器传统上使用外部网关协议（EGP），实际的EGP现在已经过时，但外部路由器使用的新路由协议一般也被称为EGP，现在流行的一种EGP是边界网关协议（BGP）外部路由器通常也作为自治网络的内部路由器

* 内部路由器：自治网络内部共享路由信息的路由器被称为内部网关，它们使用被称为内部网关协议（IGP）的一组路由协议，包括路由信息协议（RIP）、开放最短路径优先（OSPF）

* 核心路由器：尽管最初的ARPAnet骨干网不再作为Internet的中心而出现，但是自治系统有时会构建自己的骨干结构，以细分和隔离流量，核心路由器支持骨干系统，核心路由器使用的路由协议包括网关到网关的协议（GGP）以及新出现的SPREAD协议

  **说明：** 自治网络内部的路由器也可能分层次进行配置，一个大型自治网络可能包含多组内部路由器，并利用外部路由器传递这些内部组之间的路由信息，自治网络的管理者可以根据设计路由器配置，并且相应的选择路由协议

## 8.3 内部路由器

之前讲过，内部路由器工作与自治网络的内部，它会掌握自己组内全部路由器所连接的网段信息，但不需要完整了解自治系统之外的网络

内部路由协议由多种，网络管理员必须根据网络情况和网络硬件兼容性选择内部路由协议：路由信息协议（RIP）和开放最短路径优先（OSPF）

RIP是一种距离矢量协议，而OSPF是一种链路状态协议，实际的协议实现都需要解决一些细节问题

**注意：多协议** 当今大多数路由器都支持多种路由协议

### 8.3.1 路由信息协议（RIP）

RIP是一种距离矢量协议，这表示它根据跳数来判断达到目的的最佳路由

**注意：RIP路由** RIP在Unix和linux上是通过routed daemon实现的

作为一种距离矢量协议，RIP需要路由器收听和集成来自其他路由器的路由和跳数信息，RIP的参与者被划分为主动和被动两种，主动RIP节点通常是参与正常的距离矢量数据交换过程的路由器，它会把自己的路由表发送给其他路由器，并且收听来自其他路由器的更新信息，被动RIP节点只收听路由更新信息，不传播自己的路由表，其典型代表就是普通计算机（主机也需要路由表）

如果接收到跳数进行处理后正好与路由表中保存的跳数一致，则会使用路由表里原有的路径，避免由于跳数相同而导致路由表不断被修改

RIP路由器每30秒广播一次更新消息，它还可以要求立即更新，像其他距离矢量协议一样，当网络处于平衡状态时，RIP工作效果最好，如果路由器的数量变得非常大，路由表的缓慢收敛就可能导致问题，处于这个原因，RIP设置了从第一台路由器到达目的的最大跳数限制，其值时15，这个规定限制了路由器组的数量，但如果以层级方式组织路由器，15跳范围之内也可以组成大型网络

RIP允许网络管理员以手动方式把低速路径的跳数设置的很大，从而影响实际的路由选择

古老的RIP协议逐渐被新的路由协议所取代比如：OSPF

### 8.3.2 开放最短路径优先（OSPF）

OSPF是比较新的内部路由协议，正在逐渐取代RIP，OSPF是个链路状态协议

OSPF路由器组中的每台路由器都被指定一个路由器ID，通常是与路由器相关联的最大IP地址（如果路由器使用了一个环回接口，路由器ID就是最大的环回地址）

链路状态路由器会建立网络拓扑的一个内部映射，利用路由器ID来鉴别拓扑里的路由器，每台路由器都把网络描绘为一个树形，自己位于树的根部，这个网络树被称为最短路径树（SPT），通过网络的路径就对应于通过SPT的路径，路由器计算每个路由的开销，开销度量包括跳数和其他一些因素，比如链路速度和链路的可靠性

## 8.4 外部路由器：BGP

如今Internet上外部路由器所以使用的最常见协议是边界网关协议（BGP），BGP已经有过多次修改，其最新的版本是BGP4

BGP用途广泛，可以用作自治系统内的内部协议，将网络细分为更小的区域，在自治系统的边缘使用的BGP版本被称为外部边界网关路由协议（eBGP），它将消息从一个自治系统传输到另外一个自治系统，在自治系统内部使用的BGP称为内部边界网关协议（iBGP）

BGP相当健壮，而且具有可扩展性，之前讲过BGP取代了早期的外部协议，其目的就是为当今的Internet提供服务，实际上如果没有BGP则当今的Internet也就不复存在，尽管现在有关BGP路由表数量的报告各不相同，但是在最近几年，BGP路由表的规模一直在以指数级进行增长，现在其路由条目已经远超30万条

IANA为每一个自治系统分派了一个唯一的数值，称为AS号或ASN，BGP使用这些AS号来构建Internet的映射，并将基于CIDR的无类别IP地址与穿越自治系统的路由关联起来，ASN提供了一种方法来识别网络是否独立于特定的IP地址（或地址范围）该方法提供了去往自治系统的冗余路径（与通过IP地址空间的单条路径相对）但是由于ASN不是分层次的，因此BGP路由器必须知道网络中的其他所有BGP路由器

**注意：** 公共ASN和私有ASN

iBGP主要用于在自治系统的内部来路由流量，它不需要IANA分配的公共ASN，内部BGP路由器使用私有ASN来转发流量，因此不会将流量转发到自治系统之外

BGP路由器使用可靠的TCP连接来传递与地址范围相关的信息，并构建用来描述网络路径的ASN链，BGP协议包括大量用于路径发现的条件（provision）以及从多个选择中选取最高效路径的技术

## 8.5 无类别路由

在之前第四章和第五章讲到，TCP/IP路由系统是围绕网络ID的概念设计的，而网络ID是基于IP地址的地址类别（A、B、C）在第五章讲到，这个地址分类系统有一些局限性，有时并不能有效的把一段地址指定给一个供应商，“无类别域间路由（CIDR）”提供了指定地址和确定路由的另一种方法，CIDR系统利用地址/掩码对于指定主机，比如204.21.128.0/17，掩码数字表示地中有多少位是术语网络ID的

如果路由协议支持CIDR，它会提供更有效的路由，CIDR让路由器能够把多累网络同等对待，从而减少了路由器之间要传输的信息，最近一些路由协议，比如OSPF和BGP4，都支持无类别寻址，最初的RIP不支持CIDR，但随后的RIP II 更新支持CIDR

## 8.6 协议栈中的更高层

工作于更高层的路由器有很多有点，比如更好的安全性，使用这种技术的另一个原因是服务质量（Qos）的概念，有些类型的数据，比如来自于Internet电话客户的数据包，对于时间的敏感性就比其他类型的数据（比如E-mail数据）更高，一旦连接建立之后，数据包必须在一个合理的时间内达到，否则童话就会不连贯，工作于应用层的路由器能够根据服务质量准则优先发送时间敏感的数据包

之后会讲到，新的IPv6协议系统提供了其他方法来满足服务质量的要求，出于对本章知识的要求，我们现在只需要知道很多复杂的现代路由器并不局限于IP转发，而且还可以根据高层协议实现其他很多服务

这些路由器通常根据OSI参考模型进行分类，第二章已经介绍过，OSI模型有七层，完成典型IP转发任务的路由器工作于OSI模型的第三层（从下向上数），所以在OSI术语中，这种典型路由器被称为第三层路由器（L3）第四层路由器工作于传输层，而第七层路由器工作于OSI模型的最高层，掌握了关于参与连接的应用程序的最多情况

## 8.7 小结

本章详细介绍了路由选择，讨论了距离矢量和链路状态路由方法，还介绍了IP转发，核心路由器，内部路由器，外部路由器，本章最后还讨论了两种常见的内部路由协议：RIP和OSPF，并且介绍了在高层协议实现路由选择的概念

## 8.8 问于答

问：为了充当路由器，为什么必须位计算机配置IP转发功能？

**答：** 路由器接收目的地址不是自己的数据报，通常情况下，TCP/IP软件会忽略不是发给自己的数据报，IP转发提供了一种方式来接收和处理必须转发到其他网络的数据报

问：大型网络为什么更适合使用链路状态路由？

**答：** 距离矢量路由的效率随着路由器数量的增加而降低，每台路由器都必须维护一个完整的目的表，网络数据在传输路径上多次被修改，另外每次更新时，即使大多数数据不变，也要发送整个路由表

问：外部路由器的作用是什么？

**答：** 外部路由器专门用于自治网络之间交换路由信息，这样就让系统中的其他路由器不必考虑达到其他网络的路由

问：RIP为什么将最大跳数设置为15？

**答：** 如果路由器的数量太多，比较缓慢的路由收敛会导致问题

## 8.9 测验

### 8.9.1 问题

1. 有哪两种动态路由？

   **答：** 激励矢量路由和链路状态路由

2. 为什么路由器必须是多宿主的？

   **答：** 一台路由器至少需要2个接口，一个接口连接到子网，另外一个接口连接到外部的网络

3. 外部路由器使用的最常见的路由协议是什么？

   **答：** BGP，边界网关协议

4. 无类别路由的效率为什么格外高？

   **答：** 因为当网络使用超网技术合并之后，几个路由表条目可以在路由表中合并为一个单一的条目

5. OSPF属于哪一种路由？

   **答：** OSPF是链路状态路由的一个例子

### 8.9.2 练习

1. 列出当今使用的三种路由协议

   **答：** RIPv2，OSPF，BGP

2. 解析与RIP相比，OSPF如何以一种更为灵活的方法来选择最佳路由

   **答：** OSPF可以使用几个参数来计算一跳路由的开销，而RIP只能使用跳数来计算

3. 列举静态路由的优势和不足

   **答：** 静态路由狠简单，而且也不需要路由器，但是如果网络比较大，静态路由就不够灵活，而且因为复杂度提升而不可管理，此时，网络中的任何变化都需要系统管理员来处理

## 8.10 关键术语

复习下列关键术语：

* 自治系统：参与到更大网络的网络，由自治实体进行维护
* 边界路由协议（BGP）：用来在自治系统之间路由流量的协议，BGP也可以用作自治系统内的内部协议
* 动态路由：一种路由技术，路由器基于该技术获得的信息来构建路由表
* 外部路由器：自治系统中的一种路由器，与其他自治系统传递路由信息
* 非直连路由：位于两个系统内部的路由器，与系统内的其他路由器交换路由信息
* IP转发：把IP数据报从同一台设备的一个网络接口传递到另一个网络接口的过程
* OSPF（开放最短路径优先）：一种常见的链路状态内部路由协议
* RIP（路由信息协议）：一种常见的距离矢量内部路由协议
* 路由协议：路由器用于汇集路由信息的协议
* SPT（最短路径树）：OSPF路由器生成的一种树形网络映射
* 静态路由：需要网络管理员手动输入路由信息的一种路由技术